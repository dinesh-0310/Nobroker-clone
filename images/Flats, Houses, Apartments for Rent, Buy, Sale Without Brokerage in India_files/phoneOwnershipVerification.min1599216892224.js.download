function showOtpFields(){clearMsg(),$("#verifyPhoneOwnership #contactNumber").attr("disabled","true"),$("#verifyPhoneOwnership .otp-group").removeClass("hide").find("input").removeAttr("disabled").val(""),$("#verifyPhoneOwnership").removeClass("editing"),$("#verifyBtn span").text("Verify")}function generateVerificationOtp(a,b){b&&nbGA.logEvent("ContactOwner","PhoneVerify-resendOTP",{});var c={};if(void 0!==a&&null!=a)c.phone=a;else{var d=$("#phoneOwnerVerificationModal #contactNumber").intlTelInput("getSelectedCountryData"),e=$("#phoneOwnerVerificationModal #contactNumber").val().replace(/\s+/g,"");e.indexOf("+91")<0&&void 0!==d&&null!=d&&void 0!==e&&null!=e?phoneNum=encodeURI("+"+d.dialCode+e):void 0!==e&&null!=e?phoneNum=encodeURI(e):nbUtils.showFormError("phoneOwnerVerificationModal #contactNumber","Invalid Phone Number","focus"),c.phone=phoneNum}$.ajax({url:"/api/v1/account/otp/send",type:"POST",data:c,success:function(a){200==a.status&&11001==a.statusCode&&phoneChanged&&showOtpFields(),b&&displayAlerts(a.message,"success",3e3)},error:function(a){displayGenericError()}})}function verifyUserOTP(){var a={};if($("#phoneVerifcationOtpErro").addClass("hide"),a.otp=$("#verifyPhoneOwnership input[name=otp]").val(),a.otp){var b=$("#phoneOwnerVerificationModal #contactNumber").intlTelInput("getNumber");b=b.replace(/\s+/g,""),a.phone=b,phoneChanged&&(a.flowType="number_change"),$.ajax({url:"/api/v1/account/otp/validate",type:"POST",data:a,success:function(a){200==a.status&&11003==a.statusCode?(phoneChanged?(nbGA.logEvent("ContactOwner","PhoneVerify-NumberChanged",{}),showUpdateSuccessScreen("Phone number successfully updated")):(nbGA.logEvent("ContactOwner","PhoneVerified",{}),showUpdateSuccessScreen("Phone number successfully verified")),sendContactDetails()):($("#phoneVerifcationOtpErro").html("otp didn't match"),$("#phoneVerifcationOtpErro").removeClass("hide"),setTimeout(function(){$("#phoneVerifcationOtpErro").addClass("hide")},2e3),$("#phoneOwnerVerificationModal .errorMsgText").html(a.message))},error:function(a){$("#phoneOwnerVerificationModal .errorMsgText").html("Something went wrong. Please try after sometime.")}})}else $("#phoneVerifcationOtpErro").text("Enter a valid OTP"),$("#phoneVerifcationOtpErro").removeClass("hide"),setTimeout(function(){$("#phoneVerifcationOtpErro").addClass("hide")},2e3)}function showUpdateSuccessScreen(a){$("#phoneOwnerVerificationModal .mainContainer.form").addClass("hide"),$("#phoneOwnerVerificationModal .mainContainer.successUpdate").removeClass("hide").find(".textMessage").text(a),setTimeout(function(){$("#phoneOwnerVerificationModal").modal("hide")},1e3)}function resetPhoneOwnerVerificationPopup(){$("#phoneOwnerVerificationModal .mainContainer.form").removeClass("hide"),$("#phoneOwnerVerificationModal .mainContainer.successUpdate").addClass("hide"),$("#phoneOwnerVerificationModal #contactNumber").val(userInfo.phone),phoneChanged=!1,showOtpFields()}function sendContactDetails(){var a={};a.flag="P";var b,c=$("#phoneOwnerVerificationModal").data("fromPage");$.ajax({url:"/api/v1/contact/process",type:"POST",data:a,success:function(a){200==a.status&&12004==a.statusCode?displayAlerts("Your request will be processed shortly.","success",5e3):200==a.status&&12003==a.statusCode?"tenantSchedule"==c?(closeTenantScheduleModal(),b='<h4 style="font-weight:bold">Under Processing!</h4> You can schedule property visit only after verifying that your account comply with nobroker.in terms & conditions. <br><br><br> <strong>Happy Broker free Hunting, <br>\tNoBroker Team</strong><br> <img style="height:15px;width:15px" src="/static/img/whatsapp-24.gif"></img> +91-8107-555-666 <br/> <i class="icon icon-phone"></i> +91-92417-00000 <br> <i class="icon icon-envelope"></i> hello@nobroker.in',$("#ownerDetailPopup .modal-title").html("Property Visit Request"),showOwnerDetail(b)):"sponsoredPropertyDetail"==c?($("#scheduleVisitCustomSlide").hide(),$("#scheduleVisitDefaultSlide").hide(),$("#scheduleVisitModalConfirmation .subText").hide(),$("#scheduleVisitModalConfirmation .scheduledTime").hide(),$("#scheduleVisitModalConfirmation").show(),$("#scheduleVisitModal").modal("show")):showOwnerDetail('<h4 style="font-weight:bold; margin-top: 0px !important; margin-bottom: 20px !important;">Account Verification Under Process</h4> Owner Contact details will be sent to you after verifying that your account complies with NoBroker <a href="/terms-and-condition" target="_blank">Terms & Conditions</a>. <strong>You need not click on owner detail button again</strong>. <br><br>For more details, Please call us on +91-92417-00000 or send a mail to hello@nobroker.in.'):displayGenericError()},error:function(a){displayGenericError()}})}var phoneOwnerVerifyForm=$("#verifyPhoneOwnership")[0],phoneChanged=!1;$("#phoneOwnerVerificationModal #verifyBtn").on("click",function(){clearMsg();var a=$("#phoneOwnerVerificationModal #contactNumber").intlTelInput("getNumber");a=a.replace(/\s+/g,"");var b=$("#phoneOwnerVerificationModal #contactNumber").intlTelInput("getSelectedCountryData");validateIndianPhoneNumberOnly(a,b)?$("#verifyPhoneOwnership .otp-group").hasClass("hide")?(phoneChanged=$("#phoneOwnerVerificationModal #contactNumber").val()!=$("#phoneOwnerVerificationModal").data("phone"),generateVerificationOtp(),showOtpFields()):verifyUserOTP():$("#phoneOwnerVerificationModal .errorMsgText").html("Invalid")}),$("#verifyPhoneOwnership #editNumber").on("click",function(){nbGA.logEvent("ContactOwner","PhoneVerify-EditNumber",{}),clearMsg(),$("#phoneOwnerVerificationModal #contactNumber").val(""),$("#verifyBtn span").text("Generate OTP"),$("#verifyPhoneOwnership").addClass("editing"),$("#verifyPhoneOwnership #contactNumber").removeAttr("disabled"),$("#verifyPhoneOwnership .otp-group").addClass("hide").find("input").attr("disabled","true")}),$("#phoneOwnerVerificationModal").on("click","#generateOtpLink",function(){generateVerificationOtp(),showOtpFields()}),$("#verifyPhoneOwnership").submit(function(){return $("#phoneOwnerVerificationModal #verifyBtn").trigger("click"),!1}),function(){$(document).on("shown.bs.modal","#phoneOwnerVerificationModal",function(){resetPhoneOwnerVerificationPopup(),$("#phoneOwnerVerificationModal #contactNumber").intlTelInput({nationalMode:!0,separateDialCode:!0,initialCountry:"in",autoPlaceholder:"off",utilsScript:"https://assets.nobroker.in/static/lib/universal/intlTelInputUtil.js"}),$("#phoneOwnerVerificationModal .intl-tel-input").css("width","100%"),$("#phoneOwnerVerificationModal .selected-flag").css("background","white")}),$(document).on("hidden.bs.modal","#phoneOwnerVerificationModal",function(){$("#phoneOwnerVerificationModal #contactNumber").intlTelInput("destroy")})}();