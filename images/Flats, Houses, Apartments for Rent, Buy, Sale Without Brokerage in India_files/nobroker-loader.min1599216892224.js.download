function doPropertySearchFromAPI(a,b,c,d,e,f){$.ajax({url:"/api/v4/localities/"+a+"/type",success:function(a){doPropertySearchSuccessCallback(a,b,c,d,e),nbCache.put(f,a,{staleTime:1440})},error:function(a){doPropertySearchErrorCallback(a,c,e),nbCache.put(f,a,{staleTime:1})}})}function doPropertySeacrh(a,b,c,d,e){var f="";if(void 0!==b&&null!=b&&(f=b.place_id),d)return void(window.location.href=buildSearchResultsUrl(!1,a,null,!0));if("undefined"!=typeof nbCache){var g=f+"-type",h=nbCache.get(g);void 0!==h&&("success"==h.status?doPropertySearchSuccessCallback(h,b,a,c,e):doPropertySearchErrorCallback(h,a,e)),h&&void 0!==h||nbCache.get(g,{loader:doPropertySearchFromAPI(f,b,a,c,e,g)})}void 0!==e&&0==e&&fetchBuilderCards(!1)}function doPropertySearchSuccessCallback(a,b,c,d,e){homePageSearchAdobeEvent(),a&&201==a.status_code?(isTravelPolygonAvailable=!0,"undefined"!=typeof Storage&&(void 0==d&&null==d||addLocToHistory(c,b)),$("#panel-map").hasClass("active")||$("#panel-list").hasClass("active")?(doSearchAndUpdateResults(),scrollToTopOnLocalityChange(e)):(scrollToTopOnLocalityChange(e),window.location.href=buildSearchResultsUrl(!0,c,!0))):203==a.status_code?(isTravelPolygonAvailable=!1,isRegion=!0,"undefined"!=typeof Storage&&(void 0==d&&null==d||addLocToHistory(c,b)),$("#panel-map").hasClass("active")||$("#panel-list").hasClass("active")?(doSearchAndUpdateResults(),scrollToTopOnLocalityChange(e)):(scrollToTopOnLocalityChange(e),window.location.href=buildSearchResultsUrl("",c))):(isTravelPolygonAvailable=!1,$("#panel-map").hasClass("active")||$("#panel-list").hasClass("active")?(doSearchAndUpdateResults(),scrollToTopOnLocalityChange(e)):(scrollToTopOnLocalityChange(e),window.location.href=buildSearchResultsUrl(!0,c)))}function doPropertySearchErrorCallback(a,b,c){$("#panel-map").hasClass("active")||$("#panel-list").hasClass("active")?(doSearchAndUpdateResults(),scrollToTopOnLocalityChange(c)):(scrollToTopOnLocalityChange(c),window.location.href=buildSearchResultsUrl(!0,b))}function addLocToHistory(a,b){NBHistory.addToSearchHistory(a,getCity(),b.formatted_address,b.place_id,"function"==typeof b.geometry.location?b.geometry.location.lat():b.geometry.location.lat,"function"==typeof b.geometry.location?b.geometry.location.lng():b.geometry.location.lng);var c={};c.searchType="commercial_rent"==a?"commercial/rent":"commercial_buy"==a?"commercial/buy":a.toLowerCase(),c.city=getCity(),c.locality=b.formatted_address.split(",")[0],c.localityId=b.place_id,c.latitude="function"==typeof b.geometry.location?b.geometry.location.lat():b.geometry.location.lat,c.longitude="function"==typeof b.geometry.location?b.geometry.location.lng():b.geometry.location.lng;var d=$("#nbBHKSelector").find("input[type='checkbox']:checked"),e="";d.each(function(a){e+=$(this).data("bhkval"),a<d.length-1&&(e+=",")}),c.type=e,c.searchedOn=Date.now();try{window.localStorage.lastSearch=JSON.stringify(c)}catch(a){}}function isNight(){var a=(new Date).getHours();return!(a>=6&&a<19)}function changeToNight(){addClassHandle(".nb-title","night"),addClassHandle(".nb-whatsapp-number","night"),addClassHandle(".trains","night"),addClassHandle(".car","night"),addClassHandle(".sedan","night"),addClassHandle(".bus","night"),addClassHandle(".auto","night"),addClassHandle(".cloud1","night"),addClassHandle(".cloud2","night"),addClassHandle(".plane","night"),addClassHandle(".nb-bgimage","night"),addClassHandle(".nb-home-container-index","night"),setInterval(function(){$(".plane").toggleClass("night1")},500)}function removeClassHandle(a,b){$(a).hasClass(b)&&$(a).removeClass(b)}function addClassHandle(a,b){$(a).hasClass(b)||$(a).addClass(b)}function changeToMorning(){removeClassHandle(".nb-title","night"),removeClassHandle(".nb-whatsapp-number","night"),removeClassHandle(".trains","night"),removeClassHandle(".car","night"),removeClassHandle(".sedan","night"),removeClassHandle(".bus","night"),removeClassHandle(".auto","night"),removeClassHandle(".cloud1","night"),removeClassHandle(".cloud2","night"),removeClassHandle(".plane","night"),removeClassHandle(".nb-bgimage","night"),removeClassHandle(".nb-home-container-index","night")}function handleEstType(a){a&&201==a.status_code?$("#searchButtonHomePage").length>0&&($("#nbTravelTimeFilter").is(":visible")?$("#nbTravelTimeFilter").addClass("hide"):1===homepage_selected_localities.length&&$("#nbTravelTimeFilter").removeClass("hide")):$("#nbTravelTimeFilter").is(":visible")&&$("#nbTravelTimeFilter").addClass("hide")}function checkEstablishmentTypeFromAPI(a,b){$.ajax({url:"/api/v4/localities/"+a+"/type",method:"GET",success:function(a){handleEstType(a),nbCache.put(b,a,{staleTime:1440})},error:function(a){nbCache.put(b,a,{staleTime:1})}})}function checkEstablishmentType(a){if("undefined"!=typeof nbCache){var b,c=a+"-type";void 0!==b&&handleEstType(b),b&&void 0!==b||nbCache.get(c,{loader:checkEstablishmentTypeFromAPI(a,c)})}}function getPlaceDetailsAutoComplete(a,b){var c=a;void 0!==b&&null!==b&&(c.currentLocation=b.name,c.selectedLocation=b,c.currentCity=getCity(),$("#nbPlace").val(b.place_id),void 0!==b.geometry&&null!==b.geometry&&b.geometry.location&&(c.lat="function"==typeof b.geometry.location.lat?b.geometry.location.lat():b.geometry.location.lat,c.lon="function"==typeof b.geometry.location.lng?b.geometry.location.lng():b.geometry.location.lng,c.lat_lng=("function"==typeof b.geometry.location.lat?b.geometry.location.lat():b.geometry.location.lat)+","+("function"==typeof b.geometry.location.lng?b.geometry.location.lng():b.geometry.location.lng),$("#lat_lng").val(c.lat_lng)))}function loadBuildingValues(a,b){b.length>0&&void 0!=a&&""!=a&&(a=a.toLowerCase(),names=new Array,valuemap={},$.getJSON("/static/building/"+a+"_formatted_building.json",function(c){var d=c[a];for(i=0;i<d.length;i++)names.push(d[i].name),valuemap[d[i].name]=d[i].location;b.length>0&&(b.data("source",names),b.data("hidden",valuemap),void 0!=b.data("typeahead")&&(b.data("typeahead").source=names))}))}function loadLocalityValues(a,b){b.length>0&&void 0!=a&&""!=a&&(a=a.toLowerCase(),names=new Array,valuemap={},$.getJSON("/static/"+a+".json",function(c){var d=c[a];for(i=0;i<d.length;i++)names.push(d[i].name),valuemap[d[i].name]=d[i].location;b.length>0&&(b.data("source",names),b.data("hidden",valuemap),void 0!=b.data("typeahead")&&(b.data("typeahead").source=names))}))}function getCity(){var a=$("#nbrc").val();return a=void 0==a||""==a?"mumbai":a.toLowerCase(),"gurugram"==a&&(a="gurgaon"),"secunderabad"==a&&(a="hyderabad"),"mumbai"!=a&&"bangalore"!=a&&"pune"!=a&&"chennai"!=a&&"gurgaon"!=a&&"hyderabad"!=a&&"delhi"!=a&&"noida"!=a&&"greater_noida"!=a&&"ghaziabad"!=a&&"faridabad"!=a?"mumbai":a}function getNameForGooglePlace(a){for(var b=0;b<a.address_components.length;b++){var c=a.address_components[b];if(-1!=c.types.indexOf("sublocality")){locality=c.short_name;break}}"locality"==locality&&(locality=a.name)}function buildSearchResultsUrl(a,b,c,d){var e,f="locality",g="";if(d||googleAutoComplete.selectedLocation.place_id){if(d)f="Near by Properties";else if(homepage_selected_localities.length>1)f="multiple";else{for(var h=googleAutoComplete.selectedLocation,i=0;i<h.address_components.length;i++){var j=h.address_components[i];if(-1!=j.types.indexOf("sublocality")){f=j.short_name;break}}"locality"==f&&(f=h.name),f=f.replace(/\//g,function(a){return""})}d&&(void 0!=googleAutoComplete.locationObj.city||""!=googleAutoComplete.locationObj.city||null!=googleAutoComplete.locationObj.city)?googleAutoComplete.currentCity=googleAutoComplete.locationObj.city:googleAutoComplete.currentCity=getCity();var k=b.toLowerCase();if("shared"==k&&(k="rent"),"commercial_rent"==k&&(k="commercial/rent"),"commercial_buy"==k&&(k="commercial/buy"),e="/property/"+k+"/"+googleAutoComplete.currentCity+"/"+f,"pg"!=b.toLowerCase()&&"shared"!=b.toLowerCase()){var l=$("#nbBHKSelector").find("input[type='checkbox']:checked");l.each(function(a){g+=0==a?"?type="+$(this).data("bhkval"):$(this).data("bhkval"),a<l.length-1&&(g+=",")}),"sale"===b.toLowerCase()?nbGA.logEvent("PropertyFilter","bhk-home-buy",{}):"rent"===b.toLowerCase()&&nbGA.logEvent("PropertyFilter","bhk-home-rent",{})}else{var m=$("#nbGenderSelector").find("input[type='checkbox']:checked");1===m.length&&("pg"===b.toLowerCase()&&(g+="?gender="+m.data("genderval").toUpperCase(),nbGA.logEvent("PropertyFilter","type-home-pg",{})),"shared"===b.toLowerCase()&&(g+="?tenantType="+m.data("genderval").toUpperCase(),nbGA.logEvent("PropertyFilter","type-home-sharing",{})))}if(e+=g,nbPlace="searchParam="+window.btoa(JSON.stringify(homepage_selected_localities)),e+=g?"&"+nbPlace:"?"+nbPlace,"rent"===b.toLowerCase()){var n=$("#nbShiftingTimeSelector .selectedShiftingTime").data("key");n&&(e+="&availability="+n,nbGA.logEvent("PropertyFilter","availability-home-rent",{}))}if("sale"===b.toLowerCase()){var o=$("#searchFilterPropertyStatusSelector .selectedPropertyStatus").data("key");0!==o&&-1!==o||(e+="&propertyAge="+o,nbGA.logEvent("PropertyFilter","propAge-home-buy",{}))}if("pg"===b.toLowerCase()){var p=$("#searchFilterSharingTypeSelector .selectedSharingType").data("key");p&&(e+="&occupancy="+p,nbGA.logEvent("PropertyFilter","occupancy-home-pg",{}))}if("shared"===b.toLowerCase()){var q=$("#searchFilterFlatmateSharingTypeSelector .selectedFlatmateSharingType").data("key");q&&(e+="&accomodationType="+q,nbGA.logEvent("PropertyFilter","occupancy-home-sharing",{}))}if("commercial_rent"===b.toLowerCase()||"commercial_buy"===b.toLowerCase()){var r=$("#searchFilterCommercialPropertyTypeSelector").find("input[type='checkbox']:checked"),s="";r.each(function(a){s+=$(this).data("key"),a<r.length-1&&(s+=",")}),s&&(e+="&commercialPropertyType="+s,"commercial_rent"===b.toLowerCase()?nbGA.logEvent("PropertyFilter","type-home-commercial_rent",{}):nbGA.logEvent("PropertyFilter","type-home-commercial_buy",{}))}if(e+="&radius=2.0","shared"==b.toLowerCase()?e+="&sharedAccomodation=1":"rent"==b.toLowerCase()&&(e+="&sharedAccomodation=0"),$("#nbTravelTimeFilter").length>0&&$("#nbTravelTimeFilter").is(":visible")){var t=$("#searchFilterTravelTimeSelector .selectedTravelTime").data("key")||45;e+="&travelTime="+t+"&traffic=false";var u="Travel_Time_"+t;nbGA&&nbGA.logEvent("PropertyFilter",u,{})}}return e}function setShiftingDate(a){if($("#moveInDateHiddenError").addClass("hide"),"pick-date"==a)return $("#moveInDateHidden").val($(".pick-date").val()),$("label.immediate, label.within-month").removeClass("active-date"),$("input.pick-date").addClass("active-date"),void $("#moveInDateHidden").addClass("active-date");var b=new Date,c=new Date(b.getTime()+6048e5),d=new Date(b.getTime()+1296e6);a?($("#moveInDateHidden").val(getFormattedDate(c)),$("#alert-shifting-date").val(""),$("label.immediate").addClass("active-date"),$("label.within-month, input.pick-date").removeClass("active-date active")):($("#moveInDateHidden").val(getFormattedDate(d)),$("#alert-shifting-date").val(""),$("label.immediate, input.pick-date").removeClass("active-date active"),$("label.within-month").addClass("active-date"))}function initGetAlerts(a){"RESALE"===a&&(a="BUY"),$("[data-action='getPropAlerts']").off("click"),$("#alertReqPopup").off("hidden.bs.modal"),$("#alertReqPopup [data-action='submitPropAlerts']").off("click"),$(document).on("click","[data-action='getPropAlerts']",showGetAlertsPopup),$(document).on("hidden.bs.modal","#alertReqPopup",function(){refreshPageIfLoginStateChange()}),$(document).on("click","#alertReqPopup [data-action='submitPropAlerts']",function(){nbGA.logEvent("Requirement","GetAlerts-submit",{});var a=$(this).data("isloggedin");if(!a&&!$("#getAlertsForm")[0].checkValidity())return void $("#hiddenGetAlerts").click();var b=JSON.parse($("#alertReqPopup [data-action='submitPropAlerts']").data("submitparams"));if(b.localityId=b.latitude=b.longitude=b.locality="",b.localities&&b.localities.length>0&&b.localities.forEach(function(a,c){b.localityId+=a.placeId,b.localityId+=c!==b.localities.length-1?",":"",b.latitude+=a.lat,b.latitude+=c!==b.localities.length-1?",":"",b.longitude+=a.lon,b.longitude+=c!==b.localities.length-1?",":"",b.locality+=a.placeName,b.locality+=c!==b.localities.length-1?"__":""}),b.localitiesCount=b.localities.length,delete b.localities,b.name=$("#alertReqPopup #userName").val(),b.email=$("#alertReqPopup input[type='email']").val(),a)b.phone=$("#alertReqPopup #userPhone").val(),b.userId=$(this).data("userid");else{var c=$(".userDetails #userPhone").intlTelInput("getSelectedCountryData"),d=$(".userDetails #userPhone").val().replace(/\s+/g,"");if(c&&c.dialCode?b.phone="+"+c.dialCode+d:b.phone="+91"+d,!validateIndianPhoneNumberOnly(d,c))return void displayAlerts("Please enter a valid phone number","danger","3000")}if(""==$("#moveInDateHidden").val())return void $("#alertReqPopup #moveInDateHiddenError").removeClass("hide");b.city=getCity(),b.productType=$("#nbpt").val(),b.frequency=$('#alertReqPopup input[name="frequency"]:checked').val(),b.moveInDate=$("#moveInDateHidden").val().split("/").join("-"),b.requirementSource="GET_ALERTS",subscribePropertyAlert(b)});var b=new Date,c=new Date(b.getTime()+864e5),d=new Date(b.getTime()+15552e6);$("#alert-shifting-date").datepicker({autoclose:!0,todayHighlight:!0,format:"dd-mm-yyyy",startDate:c,endDate:d})}function getLatLngValForLocation(a){var b,c=$("'#"+a+"'").val();if(c){b=$("#location").data("hidden")[c];var d=b.ob+","+b.pb;$("#location").data("latlng",d),$("#location").data("latitude",b.ob),$("#location").data("longitude",b.pb)}return b}function recentSearch(a){var b=$(a).find(".localityValue").data("placeid");$("#nbPlace").val(b),googleAutoComplete.intializeAutoComplete(),checkEstablishmentType(b)}function requestCurrentLocation(){$("#currentLocationPicker").addClass("hide");var a={timeout:15e3,maximumAge:3e5};navigator.geolocation&&(this.locationSupported=!0,navigator.geolocation.getCurrentPosition(locationObtained,showLocationError,a)),nbGA.logEvent("search","home-nearby",{})}function showLocationError(a){switch($("#currentLocationPicker").removeClass("hide"),a.code){case a.PERMISSION_DENIED:displayAlerts("Request for location is denied by the user","danger",5e3);break;case a.POSITION_UNAVAILABLE:displayAlerts("Location information is unavailable","danger",5e3);break;case a.TIMEOUT:displayAlerts("The request to get user location timed out","danger",5e3);break;case a.UNKNOWN_ERROR:displayAlerts("An unknown error occurred","danger",5e3)}}function scrollToTopOnLocalityChange(a){0==a&&$("html, body").animate({scrollTop:0},600)}function saveLocalityData(a){if(a){var b={};a.selectedLocation.name&&(b.name=a.selectedLocation.name),a.selectedLocation.place_id&&(b.placeId=a.selectedLocation.place_id),a.selectedLocation.geometry.location.lat()&&(b.lat=a.selectedLocation.geometry.location.lat(),b.lon=a.selectedLocation.geometry.location.lng()),a.selectedLocation.formatted_address&&(b.formattedAddress=a.selectedLocation.formatted_address),a.selectedLocation.formatted_address&&(b.type=JSON.stringify(a.selectedLocation.types)),a.selectedLocation.formatted_address&&(b.addressComponent=JSON.stringify(a.selectedLocation.address_components));var c=a.selectedLocation.address_components;$.each(c,function(a,c){if(c){var d=c.types;d&&$.each(d,function(a,d){"locality"==d&&(b.city=c.long_name)})}}),$.ajax({type:"POST",url:"/api/v1/localities/saveLocalityData",data:b,success:function(a){}})}}function queryStringToJSON(a){a.indexOf("?")>-1&&(a=a.split("?")[1]);var b=a.split("&"),c={};return b.forEach(function(a){a=a.split("="),c[a[0]]&&(c[a[0]]=decodeURIComponent(a[1]||""))}),c}function getFiltersMap(a,b){var c=[];if(c=[],a.localities.forEach(function(a){c.push({name:"locality",value:a.placeName,text:a.placeName})}),"RENT"==b||"SHARED"==b){if("0"==a.sharedAccomodation){if(a.type){var d=a.type.split(",");$.each(d,function(a,b){var d={};d.name="type",d.value=b,d.text=window.typeMap[b],c.push(d)})}}else{if(a.accomodationType){var e=a.accomodationType.split(",");$.each(e,function(a,b){var d={};d.name="accomodationType",d.value=b,d.text=window.accomodationTypeMap[b],c.push(d)})}if(a.tenantType){var f={};f.name="tenantType",f.value=a.tenantType,f.text=window.tenantTypeMap[f.value],c.push(f)}}if("buildingType"in a){var g=a.buildingType.split(",");a.propertyType=a.buildingType,$.each(g,function(b,d){"AP"==d&&(a.propertyType=a.propertyType.replace("AP","APARTMENT"));var e={};e.name="propertyType",e.value=d,e.text=window.propertyTypeMap[d],c.push(e)})}if(a.leaseOnly){var h={};h.name="leaseOnly",h.value=a.leaseOnly,h.text="For Lease",c.push(h)}if(a.furnishing){var i=a.furnishing.split(",");$.each(i,function(a,b){var d={};d.name="furnishing",d.value=b,d.text=window.furnishingMap[b],c.push(d)})}if(a.rent){var j={};j.name="rent",j.value=a.rent,j.text=(a.budgetMin<1e3?a.budgetMin:a.budgetMin/1e3+"K")+" - "+a.budgetMax/1e3+"K",c.push(j)}if(a.leaseType){var k=a.leaseType.split(",");$.each(k,function(a,b){var d={};d.name="leaseType",d.value=b,d.text=window.preferredTenantsMap[b],c.push(d)})}}else if("BUY"==b){if(a.type){var d=a.type.split(",");$.each(d,function(a,b){var d={};d.name="type",d.value=b,d.text=window.typeMap[b],c.push(d)})}if("propType"in a){var l=a.propType.split(",");a.propertyType=a.propType,$.each(l,function(b,d){"AP"==d&&(a.propertyType=a.propertyType.replace("AP","APARTMENT"));var e={};e.name="propertyType",e.value=d,e.text=window.propertyTypeMap[d],c.push(e)})}if(a.price){var m={};m.name="price",m.value=a.price,m.text=(a.budgetMin<1e3?a.budgetMin:a.budgetMin/1e3+"K")+" - "+a.budgetMax/1e3+"K",c.push(m)}if("propertyAge"in a){var n={};n.name="propertyStatus",-1==a.propertyAge?a.propertyStatus="UNDER_CONSTRUCTION":a.propertyStatus="READY",n.value=a.propertyStatus,n.text=window.propertyAgeMap[a.propertyAge],c.push(n)}}else if("PG"==b){if(a.rent){var j={};j.name="rent",j.value=a.rent,j.text=(a.budgetMin<1e3?a.budgetMin:a.budgetMin/1e3+"K")+" - "+a.budgetMax/1e3+"K",c.push(j)}if(a.gender){a.tenantType=a.gender,delete a.gender;var o={};o.name="tenantType",o.value=a.tenantType,o.text=window.genderMap[a.tenantType],c.push(o)}if(a.occupancy){var p=a.occupancy.split(",");$.each(p,function(a,b){var d={};d.name="occupancy",d.value=b,d.text=window.occupancyMap[b],c.push(d)})}if(a.availableFor){a.leaseType=a.availableFor,delete a.availableFor;var q={};q.name="leaseType",q.value=a.leaseType,q.text=window.availableForMap[a.leaseType],c.push(q)}}return c}function removePropertyFilter(a){a.stopPropagation();var b=$(a.target).parent(),c=b.data("name"),d=JSON.parse($("#alertReqPopup [data-action='submitPropAlerts']").data("submitparams"));if("rent"==c||"price"==c)delete d.budgetMax,delete d.budgetMin,delete d[c];else if("locality"==c||"leaseOnly"==c)delete d[c];else if(void 0!==d[c]||null!==d[c]){var e=d[c].split(","),f=e.indexOf(b.data("value"));f>-1&&e.splice(f,1),e.length>0?d[c]=e.join(","):delete d[c]}$("#alertReqPopup [data-action='submitPropAlerts']").data("submitparams",JSON.stringify(d)),b.remove()}function subscribePropertyAlert(a){$("#alertReqPopup [data-action='submitPropAlerts']").attr("disabled","true"),$.ajax({url:"/api/v1/requirement/alert",method:"POST",data:a,success:function(a){200==a.status&&200==a.statusCode?($("#alertReqPopup").modal("hide"),$("#alertReqPopup [data-action='submitPropAlerts']").removeAttr("disabled"),displayAlerts("You've successfully subscribed to alerts","success",3e3),1==a.otherParams.isNewUser&&window.location.reload()):($("#alertReqPopup [data-action='submitPropAlerts']").removeAttr("disabled"),displayAlerts("Something went wrong. Please try again later.","error",3e3))},error:function(a){$("#alertReqPopup [data-action='submitPropAlerts']").removeAttr("disabled"),displayAlerts("Something went wrong. Please try again later.","error",3e3)}})}function showGetAlertsPopup(a){"undefined"!=typeof vent&&vent.trigger("showAlerts")}function homePageSearchAdobeEvent(){var a=$("input[name=rent-property-type]:checked").val(),b=$("#nbBHKSelector").find("input[type='checkbox']:checked"),c="",d=$("#nbpt").val();if(b.each(function(a){c+=$(this).data("bhkval"),a<b.length-1&&(c+=",")}),"RENT"==d||"PG"==d||"SHARED"==d)var e={rentalType:"rent"==a?"full house":"shared"==a?"flatmates":"pg",bhk:c.replace(/,/g,"|"),movingDate:$(".selectedShiftingTime").text().toLowerCase().split(" ").join("_")};if("BUY"==d)var f={type:c.replace(/,/g,"|"),propStatus:"property status"==$(".selectedPropertyStatus").text().toLowerCase()?null:$(".selectedPropertyStatus").text().toLowerCase()};if("COMMERCIAL_RENT"==d||"COMMERCIAL_BUY"==d){var g=$("#searchFilterCommercialPropertyTypeSelector").find("input[type='checkbox']:checked"),h="";g.each(function(a){h+=$(this).data("key"),a<g.length-1&&(h+=",")});var i={type:$("input[name=commercial-property-ownership-type]:checked").val(),propType:""==h?null:h.replace(/,/g,"|")}}var j=$("#homePageLocalitySearch #selectedLocalities").find(".selected-localtiy"),k="";j.each(function(a){k+=$(this).data("value"),a<j.length-1&&(k+=",")});var l={searchType:$("#nbpt").val(),searchCitySelected:$(".selectedcity").data("key"),searchLocality:k.replace(/,/g,"|")};nbAdobeEvents.registerEvent({pageName:"homepage",platform:"nb-web",siteSection:"homepage_search",flowName:"search_journey",service:nbAdobeService.getServiceName($("#nbpt").val())},"Search_HP",getuserInfoForAdobeEvent(),{eventName:"search",eventType:"button click",ctaName:"search button"},l,null,null,e,i,f)}var isTravelPolygonAvailable=!1,homepage_selected_localities=[],getLocalityInfoParam=function(){var a={};if(window.location.search.split("?")[1]){if(window.location.search.split("?")[1].split("&").forEach(function(b){a[b.split("=")[0]]=b.split("=")[1]}),a.searchParam){a.searchParam=JSON.parse(window.atob(a.searchParam));var b=a.searchParam[0].lat+","+a.searchParam[0].lon;$("#lat_lng").val(b)}return a.searchParam?a.searchParam:[]}return[]},typeMap={RK1:"1 RK",BHK1:"1 BHK",BHK2:"2 BHK",BHK3:"3 BHK",BHK4:"4 BHK",BHK4PLUS:"4+ BHK"},furnishingMap={FULLY_FURNISHED:"Fully Furnished",SEMI_FURNISHED:"Semi Furnished",NOT_FURNISHED:"Not Furnished"},preferredTenantsMap={FAMILY:"Family",BACHELOR:"Bachelors",COMPANY:"Commercial"},accomodationTypeMap={SHARED_ROOM:"Shared Room",PRIVATE_ROOM:"Single Room",BOTH:"Single And Shared"},tenantTypeMap={MALE:"Male",FEMALE:"Female"},leaseMap={},propertyAgeMap={"-1":"Under Construction",0:"Ready"},genderMap={MALE:"Male",FEMALE:"Female"},availableForMap={STUDENT:"Student",PROFESSIONAL:"Professionals",BOTH:"Student or Professionals"},occupancyMap={SINGLE:"Single Room",DOUBLE:"Double Sharing",THREE:"Triple Sharing",FOUR:"Four Sharing"},propertyTypeMap={AP:"Apartment",IH:"Independent House/Villa",IF:"Independent Floor/Builder Floor"};$(document).on("click",".home-search-button, #searchButtonListPage, #searchButtonNav",function(a){window.showingNearby=!1,window.getNearby=!1;var b=$("#locationGoogle").val(),c=!1,d=!0;if(0===homepage_selected_localities.length)return displayAlerts("Please select a locality from the dropdown for searching a property","danger","3000"),d=!1,!1;if($("#searchButtonHomePage").length>0&&(c=!0,$("#locationGoogle").val("")),$("#searchButtonListPage").length>0&&($("#locationGoogleNav").val(""),fillMapLocalityPopoverContent(),$("#panel-map").hasClass("active")&&(homepage_selected_localities.length>1?($("#mapLocalityMarker").removeClass("hide"),$("#mapLocalityMarker").popover("show")):($("#mapLocalityMarker").addClass("hide"),$("#MapViewTrigger").click(),homepage_selected_localities[0].showMap=!0,infoboxInnerHTML=$(".infobox-wrapper").html(),mapView(!0)),d=!1)),d){var e=$(a.target);e.hasClass("searchButtonNav")&&gaLogging.logEventWithProductType("Search","HeaderNav",{});var f="RENT";if(""==(f="BUY"==$("#nbpt").val()?"SALE":"COMMERCIAL"==$("#nbpt").val()?"COMMERCIAL_RENT":$("#nbpt").val())&&$('[data-name="commercial"]').hasClass("active"))return displayAlerts("Please select a commercial property type from the dropdown for searching a property","danger","3000"),$("#nbCommercialTypeSelector").click(),void $(".commercialTypeSelector").css("border","1px solid red");if("outsideCurrentCity"===googleAutoComplete.selectedLocation)return void displayAlerts("Please select locality within city","danger",5e3);if($("#searchButton .icon-spin").removeClass("hide"),"searchButtonListPage"==e.attr("id")&&$("#showMore").data("page",1),"currentLocationProperties"===googleAutoComplete.selectedLocation)doPropertySeacrh(f,googleAutoComplete.selectedLocation,b,!0,c);else{var g=getCity();"chennai"==g||"pune"==g?"RENT"==f&&$("#productTypeFilter").hide():$("#productTypeFilter").show(),doPropertySeacrh(f,googleAutoComplete.selectedLocation,b,!1,c)}}});var googleAutoComplete={checkLocalityInCity:function(){var a=new google.maps.LatLngBounds(new google.maps.LatLng(googleAutoComplete.mapBounds[getCity()].swlat,this.mapBounds[getCity()].swlon),new google.maps.LatLng(this.mapBounds[getCity()].nelat,this.mapBounds[getCity()].nelon)),b=this.selectedLocation,c={};return c.lng="function"==typeof b.geometry.location.lng?b.geometry.location.lng():b.geometry.location.lng,c.lat="function"==typeof b.geometry.location.lat?b.geometry.location.lat():b.geometry.location.lat,!(void 0===b||null===b||void 0===b.geometry||null===b.geometry||"true"!==isLocalDomain&&!a.contains(c))},checkLocalityInAllOurCity:function(){for(var a=["bangalore","mumbai","pune","chennai","gurgaon","hyderabad","delhi","noida","greater_noida","ghaziabad","faridabad"],b=0;b<a.length;b++){var c=new google.maps.LatLngBounds(new google.maps.LatLng(googleAutoComplete.mapBounds[a[b]].swlat,this.mapBounds[a[b]].swlon),new google.maps.LatLng(this.mapBounds[a[b]].nelat,this.mapBounds[a[b]].nelon)),d=this.selectedLocation,e={};if(e.lng="function"==typeof d.geometry.location.lng?d.geometry.location.lng():d.geometry.location.lng,e.lat="function"==typeof d.geometry.location.lat?d.geometry.location.lat():d.geometry.location.lat,void 0!==d&&null!==d&&void 0!==d.geometry&&null!==d.geometry&&c.contains(e))return $("#nbrc").val(a[b]),!0}return!1},mapBounds:{bangalore:{swlat:12.5706,swlon:77.1075,nelat:13.4457,nelon:78.143},mumbai:{swlat:18.700176,swlon:72.609189,nelat:19.816451,nelon:73.348531},pune:{swlat:18.221437,swlon:73.503848,nelat:18.763871,nelon:74.156848},chennai:{swlat:12.725957,swlon:79.9346602,nelat:13.286248,nelon:80.419067},gurgaon:{swlat:28.251919,swlon:76.820855,nelat:28.577433,nelon:77.143579},hyderabad:{swlat:17.2185971,swlon:78.1656773,nelat:17.622781,nelon:78.665509},faridabad:{swlat:28.294998,swlon:77.237029,nelat:28.514824,nelon:77.371064},delhi:{swlat:28.408206,swlon:76.838763,nelat:28.88173,nelon:77.345306},noida:{swlat:28.397072,swlon:77.298814,nelat:28.636495,nelon:77.487029},greater_noida:{swlat:28.377965,swlon:77.410935,nelat:28.616361,nelon:77.621172},ghaziabad:{swlat:28.606072,swlon:77.238662,nelat:28.810016,nelon:77.521202}},_autoComplete:null,selectedLocation:null,setMapBounds:function(a,b){var c=new google.maps.LatLngBounds(new google.maps.LatLng(googleAutoComplete.mapBounds[b].swlat,googleAutoComplete.mapBounds[b].swlon),new google.maps.LatLng(googleAutoComplete.mapBounds[b].nelat,googleAutoComplete.mapBounds[b].nelon));this._autoComplete&&(countryRestrict={country:"in"},this._autoComplete=new google.maps.places.Autocomplete($("#"+a)[0],{componentRestrictions:countryRestrict,bounds:c}))},getid:function(){return this.id},destroyAutoCcomplete:function(){google.maps.event.clearInstanceListeners(this._autoComplete),$(".pac-container").remove()},intializeAutoComplete:function(a,b){var c=this;c.id=a,countryRestrict={country:"in"},currentCity=b||getCity(),currentLocation=void 0,lat_lng=void 0,currentCity=currentCity.toLowerCase();var d=new google.maps.LatLngBounds(new google.maps.LatLng(this.mapBounds[currentCity].swlat,this.mapBounds[currentCity].swlon),new google.maps.LatLng(this.mapBounds[currentCity].nelat,this.mapBounds[currentCity].nelon)),e=document.getElementById("locationGoogle");this._autoComplete=a?new google.maps.places.Autocomplete($("#"+a)[0],{componentRestrictions:countryRestrict,bounds:d}):new google.maps.places.Autocomplete(e,{componentRestrictions:countryRestrict,bounds:d});$("#nbPlace").val();if("locationGoogleNav"===a){var f={inputEl:a?"#"+a:"#locationGoogle",chipContainerEl:"#selectedLocalities",chipId:"selectedLocality",preselectedLocalities:homepage_selected_localities,parentContainer:"#navLocalitySearch",removeMethod:"removeSelectedLocalityFromNavSearch"};multipleLocationSelectorHelper.prefillChips(f)}google.maps.event.clearListeners(this._autoComplete,"place_changed"),this._autoComplete.addListener("place_changed",function(){"locationGoogleNav"!==a&&a||(a?$("#"+a).val("").focus():$("#locationGoogle").val("").focus());var b=c._autoComplete.getPlace();if(b&&(c.currentLocation=b.name),c.selectedLocation=b,c.currentCity=getCity(),checkLocationValidity())if(b.geometry){var d={inputEl:a?"#"+a:"#locationGoogle",chipContainerEl:"#selectedLocalities",preselectedLocalities:homepage_selected_localities,placeObj:b,chipId:"selectedLocality",removeMethod:a?"removeSelectedLocalityFromNavSearch":"removeSelectedLocality",maxAllowed:3,parentContainer:a?"#navLocalitySearch":"#homePageLocalitySearch",noInputClass:"locality-search-no-input",isNavSearch:!!a,currentLocEl:"#currentLocationPicker"};"locationGoogleNav"!==a&&a||(homepage_selected_localities.length<3?multipleLocationSelectorHelper.addSelectedLocalityChip(d):displayAlerts("Max 3 localtion can be serached at once","danger",3e3)),getPlaceDetailsAutoComplete(c,b),b&&b.place_id&&(1===homepage_selected_localities.length?checkEstablishmentType(b.place_id):nbUtils.clearTravelTimeFilter()),b.geometry.location&&(c.lat=b.geometry.location.lat(),c.lon=b.geometry.location.lng())}else $("#locationGoogle").focus()})}},removeSelectedLocality=function(a){var b=$(a.target).parent(),c={inputEl:"#locationGoogle",inputElContainer:"#selectedLocalities",chipEl:b,preselectedLocalities:homepage_selected_localities,chipId:"selectedLocality",isNavSearch:!1,noInputClass:"locality-search-no-input",currentLocEl:"#currentLocationPicker"};multipleLocationSelectorHelper.removeSelectedLocalityEl(c)};$(function(){if($("#location").length>0||$("#reqLocation").length>0||$("#locationHeader").length>0||$("#propertyLocation").length>0||$("#manageLocation").length>0){names=new Array,valuemap={},idMap={};var a=getCity();$.getJSON("/static/"+a+".json",function(b){var c=b[a];for(i=0;i<c.length;i++)names.push(c[i].name),valuemap[c[i].name]=c[i].location,idMap[c[i].name]=c[i].place_id;$("#location").length>0&&($("#location").data("source",names),$("#location").data("hidden",valuemap),$("#location").data("idMap",idMap)),$("#reqLocation").length>0&&($("#reqLocation").data("source",names),$("#reqLocation").data("hidden",valuemap),$("#reqLocation").data("idMap",idMap)),$("#locationHeader").length>0&&($("#locationHeader").data("source",names),$("#locationHeader").data("hidden",valuemap),$("#locationHeader").data("idMap",idMap)),$("#propertyLocation").length>0&&($("#propertyLocation").data("source",names),$("#propertyLocation").data("hidden",valuemap),$("#propertyLocation").data("idMap",idMap)),$("#manageLocation").length>0&&($("#manageLocation").data("source",names),$("#manageLocation").data("hidden",valuemap),$("#manageLocation").data("idMap",idMap))}),$("#location").change(function(){var a,b=$("#nbrc").val(),c=$("#location").val();if(c){a=$("#location").data("hidden")[c];var d=a.ob+","+a.pb;$("#location").data("latlng",d),$("#location").data("latitude",a.ob),$("#location").data("longitude",a.pb)}if($("#location").hasClass("input-home-search")){var e="/property/rent/"+b+"/"+$("#location").val(),f=$("#nbBHKSelector").find("input[type='checkbox']:checked"),g="";f.each(function(a){g+=0==a?"?type="+$(this).data("bhkval"):$(this).data("bhkval"),a<f.length-1&&(g+=",")}),e+=g,window.location.href=e}else if(c){ga("send","event","PropertyFilter",$("#location").val(),$("#location").val()+" searched from filter"),doSearchAndUpdateResults();var h="/property/rent/"+b+"/"+$("#location").val();$("#searchBinHider").click(),History.pushState("","No Broker: Search for a rental home",h)}else{var i=$("#locCheckForm");i[0].checkValidity()||$("#hiddenLocCheckForm").click()}}),$("#reqLocation").change(function(){var a,b=$("#reqLocation").val();if(b&&void 0!=(a=$("#reqLocation").data("hidden")[b])){var c=a.ob+","+a.pb;$("#reqLocation").data("latlng",c),$("#reqLocation").data("latitude",a.ob),$("#reqLocation").data("longitude",a.pb)}}),$("#reqLocation").blur(function(){var a=$("#reqLocation").val();$("#reqLocation").data("hidden")[a]||$("#reqLocation").val("")}),$("#location").blur(function(){var a=$("#location").val();$("#location").data("hidden")[a]||$("#location").val("")}),$("#locationHeader").change(function(){ga("send","event","PropertyFilter",$("#locationHeader").val(),$("#locationHeader").val()+" searched from page header");var a,b=$("#locationHeader").val();if(b){a=$("#locationHeader").data("hidden")[b];var c=a.ob+","+a.pb;$("#locationHeader").data("latlng",c),$("#locationHeader").data("latitude",a.ob),$("#locationHeader").data("longitude",a.pb)}var d=getCity(),e="/property/rent/"+d+"/"+$("#locationHeader").val();window.location.href=e})}$(".profile-info .dropdown").on("mouseover",function(){$(".profile-info .dropdown").addClass("open")})}),$("#manageLocation").change(function(){var a,b=$("#manageLocation").val();if(b&&void 0!=(a=$("#manageLocation").data("hidden")[b])){var c=a.ob+","+a.pb;$("#manageLocation").data("latlng",c),$("#propLatitude").data("latitude",a.ob),$("#propLongitude").data("longitude",a.pb)}});try{$(".selectpicker").selectpicker()}catch(a){}$(function(){$(".busy-holder").hide()}),$(".help-popup").mouseover(function(){showHelpContent($(this))}),$(".help-popup").mouseout(function(){hideHelpContent()});try{$.webshims.polyfill("forms")}catch(a){}var checkLocationValidity=function(){if(isHomePage=!1,$("#searchButtonHomePage").length>0&&(isHomePage=!0),googleAutoComplete.selectedLocation){if(-1!==homepage_selected_localities.findIndex(function(a){return a.placeId===googleAutoComplete.selectedLocation.place_id}))return displayAlerts("This locality is already selected, please select a different one","danger","3000"),!1;if(googleAutoComplete.checkLocalityInCity())return!0;if(!isHomePage&&0===homepage_selected_localities.length&&googleAutoComplete.checkLocalityInAllOurCity())return!0;try{displayAlerts("Please select another locality in "+getCity().substring(0,1).toUpperCase()+getCity().substring(1,getCity().length)+".","danger","4000")}catch(a){displayAlerts("Please select another locality.","danger","4000")}return!1}},placeChange=function(a,b){var c=this;"locationGoogleNav"!==(b="locationGoogle"===b?null:b)&&b||b&&$("#"+b).val("").focus();var d;if(a){if(d=a,"function"!=typeof d.geometry.location.lat){var e=d.geometry.location.lat,f=d.geometry.location.lng;d.geometry.location.lat=function(){return e},d.geometry.location.lng=function(){return f}}googleAutoComplete.currentLocation=d.name,googleAutoComplete.selectedLocation=d}if(googleAutoComplete.currentCity=getCity(),checkLocationValidity())if(d.geometry){var g={inputEl:b?"#"+b:"#locationGoogle",chipContainerEl:"#selectedLocalities",preselectedLocalities:homepage_selected_localities,placeObj:d,chipId:"selectedLocality",removeMethod:b?"removeSelectedLocalityFromNavSearch":"removeSelectedLocality",maxAllowed:3,parentContainer:b?"#navLocalitySearch":"#homePageLocalitySearch",noInputClass:"locality-search-no-input",isNavSearch:!!b,currentLocEl:"#currentLocationPicker"};"locationGoogleNav"!==b&&b||(homepage_selected_localities.length<3?multipleLocationSelectorHelper.addSelectedLocalityChip(g):displayAlerts("Max 3 localtion can be serached at once","danger",3e3)),getPlaceDetailsAutoComplete(c,d),d&&d.place_id&&(1===homepage_selected_localities.length?checkEstablishmentType(d.place_id):nbUtils.clearTravelTimeFilter()),d.geometry.location&&(c.lat=d.geometry.location.lat(),c.lon=d.geometry.location.lng()),$("#locationGoogle").val(""),$("#homepageSuggestions").html("")}else $("#locationGoogle").focus()};