!function(a,b){"function"==typeof define&&define.amd?define(["nbAutoComplete"],b):a.nbAutoComplete=b(a.options)}(window,function(){function a(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return!1}function b(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/"}return{_autoComplete:null,_selectedCity:a("nbcr")||"bangalore",_autoCompleteResponse:{},typingTimer:null,doneTypingInterval:1e3,inputId:null,suggestionId:null,page:null,useApi:!1,useCity:!0,mapBounds:{bangalore:{swlat:12.5706,swlon:77.1075,nelat:13.4457,nelon:78.143},mumbai:{swlat:18.728699,swlon:72.614028,nelat:19.816451,nelon:73.348531},pune:{swlat:18.221437,swlon:73.503848,nelat:18.763871,nelon:74.156848},chennai:{swlat:12.725957,swlon:79.9346602,nelat:13.286248,nelon:80.419067},gurgaon:{swlat:28.251919,swlon:76.820855,nelat:28.577433,nelon:77.143579},hyderabad:{swlat:17.2185971,swlon:78.1656773,nelat:17.622781,nelon:78.665509},faridabad:{swlat:28.294998,swlon:77.237029,nelat:28.514824,nelon:77.371064},delhi:{swlat:28.408206,swlon:76.838763,nelat:28.88173,nelon:77.345306},noida:{swlat:28.397072,swlon:77.298814,nelat:28.636495,nelon:77.487029},greater_noida:{swlat:28.377965,swlon:77.410935,nelat:28.616361,nelon:77.621172},ghaziabad:{swlat:28.606072,swlon:77.238662,nelat:28.810016,nelon:77.521202}},autocompleteService:null,geocoder:null,currBounds:null,autoCompleteEvents:function(){var a,b,c=void 0,d=this,e=$("#"+d.inputId),f="#"+d.inputId;$(document).off("keyup",f),$(document).on("keyup",f,function(e){try{var f=$("#propertyCity").val();f&&"undefined"!=typeof Backbone&&(d._selectedCity=f)}catch(a){}c!=$("#"+d.inputId).val()?(c=$("#"+d.inputId).val(),clearTimeout(b),a=null,b=setTimeout(d.doneTyping.bind(d),d.doneTypingInterval)):e.stopPropagation()}),$(document).off("keydown",f),$(document).on("keydown",f,function(c){clearTimeout(b);var d=e.closest("div").find(".suggestions");40===c.keyCode?a&&0!=a.length?d.children(".each-prediction").last().data("id")!==a.data("id")&&(a.removeClass("keyboard-focused"),a.next().addClass("keyboard-focused"),a=a.next()):(d.children(".each-prediction").first().addClass("keyboard-focused"),a=d.children(".each-prediction").first()):38===c.keyCode?a&&0!==a.length&&d.children(".each-prediction").first().data("id")!==a.data("id")&&(a.removeClass("keyboard-focused"),a.prev().addClass("keyboard-focused"),a=a.prev()):13===c.keyCode&&a.click()})},doneTyping:function(){var a=this;a.suggestions($("#"+a.inputId).val(),a.inputId),$("#locationGoogleClickWrapper").is(":visible")&&$("#locationGoogleClickWrapper").length>0&&$("#locationGoogleClickWrapper").click()},initializeAutocomplete:function(a,b,c,d,e,f){this.inputId=a,this.doneTypingInterval=d,this.suggestionId=b,this.page=c,this.useApi=e||this.useApi,0==f?this.useCity=f:void 0!==f&&(this._selectedCity=f);try{this.autocompleteService="undefined"!=typeof google&&google&&google.maps&&new window.google.maps.places.AutocompleteService}catch(a){}if(this.autocompleteService&&(this._selectedCity&&"null"!==this._selectedCity||(this._selectedCity="bangalore"),this.geocoder=new window.google.maps.Geocoder,this.currBounds=new google.maps.LatLngBounds(new google.maps.LatLng(this.mapBounds[this._selectedCity].swlat,this.mapBounds[this._selectedCity].swlon),new google.maps.LatLng(this.mapBounds[this._selectedCity].nelat,this.mapBounds[this._selectedCity].nelon)),this.autoCompleteEvents()),this.getSessionToken(),"locationGoogleNav"===a){var g={inputEl:a?"#"+a:"#locationGoogle",chipContainerEl:"#selectedLocalities",chipId:"selectedLocality",preselectedLocalities:homepage_selected_localities,parentContainer:"#navLocalitySearch",removeMethod:"removeSelectedLocalityFromNavSearch"};multipleLocationSelectorHelper.prefillChips(g)}return!!this.autocompleteService},fetchPredictions:function(a,b){var c=this;if(c.useApi){var d=c._selectedCity;d=0==c.useCity?"":d;var e="/api/v1/localities/autocomplete/_search?hint=";e="pac-input"===b?e+a+"&city="+d+"&page=pyp_locality_map":e+a+"&city="+d+"&page="+c.page,$.ajax({url:e,type:"GET",success:function(a){c.getGeoAddress(a,!0)},error:function(b){c.autocompleteService.getQueryPredictions({componentRestrictions:{country:"IN"},bounds:c.currBounds,input:a},c.getGeoAddress.bind(c))}})}else c.autocompleteService.getQueryPredictions({componentRestrictions:{country:"IN"},bounds:c.currBounds,input:a},c.getGeoAddress.bind(c))},suggestions:function(a,b){a.length>2?(this.fetchPredictions(a,b),"undefined"!=typeof nbGA&&nbGA&&nbGA.logEvent("googleAutoComplete","search",{page:this.page})):0==a.length&&$("#"+this.suggestionId).html("")},getGeoAddress:function(a,b){var c,d=this;c=Array.isArray(a)?a:a.predictions,d._autoCompleteResponse.data=c;var e="";null!=c&&c.length>0?(c.forEach(function(a,b){a.place_id&&(e+='<div class="each-prediction" data-id="'+b+'"><span><i class="fa fa-map-marker location-icon" aria-hidden="true"></i></span><div class="prediction-container"><div class="main-text"><span class="normal-text">'+a.structured_formatting.main_text+'</span></div><div class="secondary-text">'+a.structured_formatting.secondary_text+"</div></div></div>")}),$("#"+d.suggestionId).html('<div class="suggestions">'+e+'<div style="display:flex; justify-content:flex-end; padding:2px 5px; align-items:center; font-size:12px">powered by <img src="/static/img/google-logo.png" alt="" height="25px" width="50px"></div></div>')):$("#"+d.suggestionId).html("")},getPlaceData:function(a,b,c){var d=this,e=d._autoCompleteResponse.data[a].place_id,f=(d._selectedCity,"/api/v1/localities/place_detail/"+e+"/_search");$.ajax({url:f,type:"GET",success:function(e){e.result&&(e.result.name=d._autoCompleteResponse.data[a].structured_formatting.main_text,b&&"outOfBound"===b(e.result,c))||("propertyLocality"===c&&$("#"+c).val(d._autoCompleteResponse.data[a].structured_formatting.main_text),"pac-input"===c&&$("#"+c).val(d._autoCompleteResponse.data[a].description),$("#"+d.suggestionId).html(""))},error:function(f){d.geocoder.geocode({placeId:e},function(e,f){e&&(e[0].name=d._autoCompleteResponse.data[a].structured_formatting.main_text,b(e[0],c)),$("#"+d.suggestionId).html("")})}})},updateCityBound:function(a){this.currBounds=new google.maps.LatLngBounds(new google.maps.LatLng(this.mapBounds[a].swlat,this.mapBounds[a].swlon),new google.maps.LatLng(this.mapBounds[a].nelat,this.mapBounds[a].nelon)),this._selectedCity=a},getSessionToken:function(){var c;return null!=a("mapSessionToken")&&void 0!=a("mapSessionToken")&&""!=a("mapSessionToken")?c=JSON.parse(a("mapSessionToken")):(c=google&&google.maps&&new google.maps.places.AutocompleteSessionToken,b("mapSessionToken",JSON.stringify(c),.01)),c}}});